<?xml version="1.0" encoding="utf-8"?><asx:abap version="1.0" xmlns:asx="http://www.sap.com/abapxml"><asx:values><VERSION>1</VERSION><TYPE/><INTERFACE href="#o271"/><INTERFACET><FPINTERFACET><NAME/><STATE/><LANGUAGE>S</LANGUAGE><ID/><TEXT>Interface Recibo de Transferencia</TEXT></FPINTERFACET></INTERFACET></asx:values><asx:heap xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:abap="http://www.sap.com/abapxml/types/built-in" xmlns:cls="http://www.sap.com/abapxml/classes/global" xmlns:dic="http://www.sap.com/abapxml/types/dictionary"><cls:CL_FP_INTERFACE_DATA id="o271"><CL_FP_INTERFACE_DATA classVersion="1"><CODING href="#o267"/><PARAMETERS href="#o268"/><GLOBAL_DEFINITIONS href="#o269"/><REFERENCE_FIELDS href="#o270"/><XSD_DEFINITIONS/></CL_FP_INTERFACE_DATA></cls:CL_FP_INTERFACE_DATA><cls:CL_FP_REFERENCE_FIELDS id="o270"><CL_FP_INTERFACE_DATA_CHANGED classVersion="1"><INTERFACE_DATA href="#o271"/></CL_FP_INTERFACE_DATA_CHANGED><CL_FP_REFERENCE_FIELDS classVersion="1"><REFERENCE_FIELDS><SFPREF><ACTIVE/><STANDARD/><DATATYPE>CURR</DATATYPE><VALUE>CERT_DATA-DMBTR</VALUE><UNIT>CERT_DATA-WAERS</UNIT></SFPREF></REFERENCE_FIELDS></CL_FP_REFERENCE_FIELDS></cls:CL_FP_REFERENCE_FIELDS><cls:CL_FP_GLOBAL_DEFINITIONS id="o269"><CL_FP_INTERFACE_DATA_CHANGED classVersion="1"><INTERFACE_DATA href="#o271"/></CL_FP_INTERFACE_DATA_CHANGED><CL_FP_GLOBAL_DEFINITIONS classVersion="1"><GLOBAL_DATA><SFPGDATA><NAME>GV_TOTAL</NAME><TYPING>TYPE</TYPING><TYPENAME>CHAR30</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_CHEQUE</NAME><TYPING>TYPE</TYPING><TYPENAME>CHAR1</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_TRANSFER</NAME><TYPING>TYPE</TYPING><TYPENAME>CHAR1</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_TARJETA</NAME><TYPING>TYPE</TYPING><TYPENAME>CHAR1</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_EFECTIVO</NAME><TYPING>TYPE</TYPING><TYPENAME>CHAR1</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_LOGO</NAME><TYPING>TYPE</TYPING><TYPENAME>XSTRING</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GT_TAB</NAME><TYPING>TYPE</TYPING><TYPENAME>ZTT_RECIBO_FACTURA</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_CONCEPTO</NAME><TYPING>TYPE</TYPING><TYPENAME>XBLNR</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_CLIENTE</NAME><TYPING>TYPE</TYPING><TYPENAME>KUNNR</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_RECIBIMOS</NAME><TYPING>TYPE</TYPING><TYPENAME>NAME1</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_DIRECCION</NAME><TYPING>TYPE</TYPING><TYPENAME>STRAS</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_CIUDAD</NAME><TYPING>TYPE</TYPING><TYPENAME>ORT01</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_HORA</NAME><TYPING>TYPE</TYPING><TYPENAME>CPUTM</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_USUARIO</NAME><TYPING>TYPE</TYPING><TYPENAME>USNAM</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_FECHA2</NAME><TYPING>TYPE</TYPING><TYPENAME>BUDAT</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_NEW_DOC</NAME><TYPING>TYPE</TYPING><TYPENAME>ZCL_CODIGO</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA><SFPGDATA><NAME>GV_FECHA1</NAME><TYPING>TYPE</TYPING><TYPENAME>BUDAT</TYPENAME><DEFAULTVAL/><CONSTANT/></SFPGDATA></GLOBAL_DATA><TYPES/><FIELDSYMBOLS/></CL_FP_GLOBAL_DEFINITIONS></cls:CL_FP_GLOBAL_DEFINITIONS><cls:CL_FP_PARAMETERS id="o268"><CL_FP_INTERFACE_DATA_CHANGED classVersion="1"><INTERFACE_DATA href="#o271"/></CL_FP_INTERFACE_DATA_CHANGED><CL_FP_PARAMETERS classVersion="1"><IMPORT_PARAMETERS><SFPIOPAR><NAME>CERT_DATA</NAME><TYPING>TYPE</TYPING><TYPENAME>ZTT_RECIBO_TRANSFERENCIA</TYPENAME><OPTIONAL/><BYVALUE>X</BYVALUE><DEFAULTVAL/><STANDARD/><CONSTANT/></SFPIOPAR></IMPORT_PARAMETERS><EXPORT_PARAMETERS/><TABLE_PARAMETERS/><EXCEPTIONS/></CL_FP_PARAMETERS></cls:CL_FP_PARAMETERS><cls:CL_FP_CODING id="o267"><CL_FP_INTERFACE_DATA_CHANGED classVersion="1"><INTERFACE_DATA href="#o271"/></CL_FP_INTERFACE_DATA_CHANGED><CL_FP_CODING classVersion="1"><INPUT_PARAMETERS><FPPARAMETER>CERT_DATA</FPPARAMETER></INPUT_PARAMETERS><OUTPUT_PARAMETERS><FPPARAMETER>GV_CHEQUE</FPPARAMETER><FPPARAMETER>GV_NEW_DOC</FPPARAMETER><FPPARAMETER>GV_TRANSFER</FPPARAMETER><FPPARAMETER>GV_TARJETA</FPPARAMETER><FPPARAMETER>GV_TOTAL</FPPARAMETER><FPPARAMETER>GV_EFECTIVO</FPPARAMETER><FPPARAMETER>GV_LOGO</FPPARAMETER><FPPARAMETER>GT_TAB</FPPARAMETER><FPPARAMETER>GV_CONCEPTO</FPPARAMETER><FPPARAMETER>GV_CIUDAD</FPPARAMETER><FPPARAMETER>GV_DIRECCION</FPPARAMETER><FPPARAMETER>GV_RECIBIMOS</FPPARAMETER><FPPARAMETER>GV_USUARIO</FPPARAMETER><FPPARAMETER>GV_HORA</FPPARAMETER><FPPARAMETER>GV_USUARIO</FPPARAMETER><FPPARAMETER>GV_FECHA2</FPPARAMETER><FPPARAMETER>GV_FECHA1</FPPARAMETER></OUTPUT_PARAMETERS><INITIALIZATION><FPCLINE>DATA: ls_bsad TYPE bsad.</FPCLINE><FPCLINE/><FPCLINE>DATA: lt_tab TYPE ztt_recibo_factura,</FPCLINE><FPCLINE>      ls_tab TYPE zst_recibo_factura,</FPCLINE><FPCLINE>      lt_f28 TYPE TABLE OF zrecibo_f28,</FPCLINE><FPCLINE>      ls_f28 TYPE zrecibo_f28.</FPCLINE><FPCLINE/><FPCLINE>DATA: lv_dmbtr TYPE dmbtr.</FPCLINE><FPCLINE>DATA: lv_name        TYPE stxbitmaps-tdname,</FPCLINE><FPCLINE>      lv_field       TYPE  xstring,</FPCLINE><FPCLINE>      lv_campo       TYPE char10,</FPCLINE><FPCLINE>      lv_correlativo TYPE char13,</FPCLINE><FPCLINE>      lv_split1      TYPE char10,</FPCLINE><FPCLINE>      lv_split2      TYPE char10.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE>CLEAR: lv_dmbtr.</FPCLINE><FPCLINE>READ TABLE cert_data INTO DATA(ls_data) INDEX 1.</FPCLINE><FPCLINE>IF sy-subrc EQ 0.</FPCLINE><FPCLINE/><FPCLINE>  SELECT SINGLE * FROM bsad INTO ls_bsad</FPCLINE><FPCLINE>    WHERE belnr EQ ls_data-belnr</FPCLINE><FPCLINE>      AND bukrs EQ ls_data-bukrs</FPCLINE><FPCLINE>      AND gjahr EQ ls_data-gjahr.</FPCLINE><FPCLINE/><FPCLINE>  IF sy-subrc EQ 0.</FPCLINE><FPCLINE>    gv_fecha1 = ls_bsad-budat.</FPCLINE><FPCLINE/><FPCLINE>    SELECT SINGLE * FROM kna1 INTO @DATA(ls_kna1)</FPCLINE><FPCLINE>      WHERE kunnr EQ @ls_bsad-kunnr.</FPCLINE><FPCLINE>    IF sy-subrc EQ 0.</FPCLINE><FPCLINE>      gv_cliente   = ls_kna1-kunnr.</FPCLINE><FPCLINE>      gv_recibimos = ls_kna1-name1.</FPCLINE><FPCLINE>      gv_direccion = ls_kna1-stras.</FPCLINE><FPCLINE>      gv_ciudad    = ls_kna1-ort01.</FPCLINE><FPCLINE>    ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  SELECT SINGLE usnam cputm FROM bkpf INTO ( gv_usuario, gv_hora )</FPCLINE><FPCLINE>    WHERE belnr EQ ls_data-belnr</FPCLINE><FPCLINE>      AND bukrs EQ ls_data-bukrs</FPCLINE><FPCLINE>      AND gjahr EQ ls_data-gjahr.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE>  CLEAR: ls_bsad.</FPCLINE><FPCLINE/><FPCLINE>  SELECT * FROM bsad INTO TABLE @DATA(lt_bsad)</FPCLINE><FPCLINE>      WHERE augbl EQ @ls_data-belnr</FPCLINE><FPCLINE>        AND gjahr EQ @ls_data-gjahr</FPCLINE><FPCLINE>        AND bukrs EQ @ls_data-bukrs.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE>  LOOP AT lt_bsad INTO ls_bsad.</FPCLINE><FPCLINE/><FPCLINE>    IF ls_bsad-augbl EQ ls_data-belnr.</FPCLINE><FPCLINE/><FPCLINE>      IF ls_bsad-shkzg EQ 'H'.</FPCLINE><FPCLINE>        gv_fecha2 = ls_bsad-budat.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE/><FPCLINE>      IF ls_bsad-xblnr IS NOT INITIAL.</FPCLINE><FPCLINE>        gv_concepto  = ls_bsad-xblnr.</FPCLINE><FPCLINE>      ENDIF.</FPCLINE><FPCLINE/><FPCLINE>    ENDIF.</FPCLINE><FPCLINE/><FPCLINE>    IF ls_bsad-blart NE ls_data-blart AND ls_bsad-shkzg = 'S'. "'DZ' AND ls_bsad-shkzg = 'H'.</FPCLINE><FPCLINE>      ls_tab-belnr = ls_bsad-belnr.</FPCLINE><FPCLINE>      lv_dmbtr = lv_dmbtr + ls_bsad-dmbtr.</FPCLINE><FPCLINE>    ENDIF.</FPCLINE><FPCLINE>  ENDLOOP.</FPCLINE><FPCLINE/><FPCLINE>*  ls_tab-dmbtr = lv_dmbtr.</FPCLINE><FPCLINE>*  CONDENSE ls_tab-dmbtr.</FPCLINE><FPCLINE/><FPCLINE>  SELECT * FROM bseg INTO TABLE @DATA(lt_bseg)</FPCLINE><FPCLINE>    WHERE belnr EQ @ls_data-belnr</FPCLINE><FPCLINE>      AND bukrs EQ @ls_data-bukrs</FPCLINE><FPCLINE>      AND gjahr EQ @ls_data-gjahr.</FPCLINE><FPCLINE>*      AND koart EQ 'D'</FPCLINE><FPCLINE>*      AND sgtxt IN ( 'EFECTIVO', 'TJ', 'TRANSFERENCIA' , 'CHEQUE' ).</FPCLINE><FPCLINE/><FPCLINE>  LOOP AT lt_bseg INTO DATA(ls_bseg).</FPCLINE><FPCLINE/><FPCLINE>    IF ls_bseg-sgtxt EQ 'EFECTIVO' OR ls_bseg-sgtxt EQ 'TJ' OR ls_bseg-sgtxt EQ 'TRANSFERENCIA' OR ls_bseg-sgtxt EQ 'CHEQUE'.</FPCLINE><FPCLINE>      CASE ls_bseg-sgtxt.</FPCLINE><FPCLINE>        WHEN 'EFECTIVO'.</FPCLINE><FPCLINE>          gv_efectivo = '1'.</FPCLINE><FPCLINE>        WHEN 'TJ'.</FPCLINE><FPCLINE>          gv_tarjeta = '1'.</FPCLINE><FPCLINE>        WHEN 'TRANSFERENCIA'.</FPCLINE><FPCLINE>          gv_transfer = '1'.</FPCLINE><FPCLINE>        WHEN 'CHEQUE'.</FPCLINE><FPCLINE>          gv_cheque = '1'.</FPCLINE><FPCLINE>      ENDCASE.</FPCLINE><FPCLINE>    ENDIF.</FPCLINE><FPCLINE/><FPCLINE>    "Tomar importe restante de PAGOS PARCIALES</FPCLINE><FPCLINE>    IF ls_bseg-koart EQ 'D' AND ls_bseg-shkzg EQ 'S'.</FPCLINE><FPCLINE>      CLEAR: lv_dmbtr.</FPCLINE><FPCLINE>      lv_dmbtr = lv_dmbtr + ls_bseg-dmbtr.</FPCLINE><FPCLINE>      ls_tab-belnr = ls_bseg-belnr.</FPCLINE><FPCLINE>*      ls_tab-dmbtr = lv_dmbtr.</FPCLINE><FPCLINE>*      CONDENSE ls_tab-dmbtr.</FPCLINE><FPCLINE>    ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  ENDLOOP.</FPCLINE><FPCLINE/><FPCLINE>  ls_tab-dmbtr = lv_dmbtr.</FPCLINE><FPCLINE>  CONDENSE ls_tab-dmbtr.</FPCLINE><FPCLINE/><FPCLINE>  CONCATENATE '**********' ls_tab-dmbtr INTO gv_total.</FPCLINE><FPCLINE>  CONDENSE gv_total.</FPCLINE><FPCLINE/><FPCLINE>  APPEND ls_tab TO gt_tab.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE>*  CONCATENATE ls_data-blart '_CODIGO' INTO lv_campo.</FPCLINE><FPCLINE/><FPCLINE>  SELECT * FROM zrecibo_f28 INTO TABLE lt_f28</FPCLINE><FPCLINE>    WHERE blart EQ ls_data-blart.</FPCLINE><FPCLINE/><FPCLINE>  IF sy-subrc NE 0.</FPCLINE><FPCLINE/><FPCLINE>    ls_f28-belnr = ls_data-belnr.</FPCLINE><FPCLINE>    ls_f28-blart = ls_data-blart.</FPCLINE><FPCLINE/><FPCLINE>    CONCATENATE ls_data-blart '-0000000001' INTO lv_correlativo.</FPCLINE><FPCLINE>    ls_f28-cl_belnr = lv_correlativo.</FPCLINE><FPCLINE/><FPCLINE>    APPEND ls_f28 TO lt_f28.</FPCLINE><FPCLINE/><FPCLINE>  ELSE.</FPCLINE><FPCLINE/><FPCLINE>    SORT lt_f28 BY cl_belnr.</FPCLINE><FPCLINE/><FPCLINE>    READ TABLE lt_f28 INTO ls_f28 INDEX 1.</FPCLINE><FPCLINE/><FPCLINE>    IF ls_f28-belnr EQ ls_data-belnr AND ls_f28-blart EQ ls_data-blart.</FPCLINE><FPCLINE/><FPCLINE>      REFRESH: lt_f28.</FPCLINE><FPCLINE/><FPCLINE>      gv_new_doc = ls_f28-cl_belnr.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE>    ELSE.</FPCLINE><FPCLINE/><FPCLINE>      REFRESH: lt_f28.</FPCLINE><FPCLINE/><FPCLINE>      SPLIT ls_f28-cl_belnr AT '-' INTO lv_split1</FPCLINE><FPCLINE>                                        lv_split2.</FPCLINE><FPCLINE>      lv_split1 = lv_split2 + 1.</FPCLINE><FPCLINE/><FPCLINE>      CALL FUNCTION 'CONVERSION_EXIT_ALPHA_INPUT'</FPCLINE><FPCLINE>        EXPORTING</FPCLINE><FPCLINE>          input  = lv_split1</FPCLINE><FPCLINE>        IMPORTING</FPCLINE><FPCLINE>          output = lv_split1.</FPCLINE><FPCLINE/><FPCLINE>      ls_f28-belnr = ls_data-belnr.</FPCLINE><FPCLINE>      ls_f28-blart = ls_data-blart.</FPCLINE><FPCLINE/><FPCLINE>      CONCATENATE ls_f28-blart lv_split1 INTO lv_correlativo SEPARATED BY '-'.</FPCLINE><FPCLINE>      ls_f28-cl_belnr = lv_correlativo.</FPCLINE><FPCLINE>      APPEND ls_f28 TO lt_f28.</FPCLINE><FPCLINE/><FPCLINE>    ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>  IF lt_f28[] IS NOT INITIAL.</FPCLINE><FPCLINE>    MODIFY zrecibo_f28 FROM TABLE lt_f28.</FPCLINE><FPCLINE>    COMMIT WORK AND WAIT.</FPCLINE><FPCLINE/><FPCLINE>    gv_new_doc = ls_f28-cl_belnr.</FPCLINE><FPCLINE/><FPCLINE>  ENDIF.</FPCLINE><FPCLINE/><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE>lv_name = 'ZLOGOP16'. "'ZLOGO_IMCA'.</FPCLINE><FPCLINE/><FPCLINE>CALL METHOD cl_ssf_xsf_utilities=&gt;get_bds_graphic_as_bmp</FPCLINE><FPCLINE>  EXPORTING</FPCLINE><FPCLINE>    p_object       = 'GRAPHICS'</FPCLINE><FPCLINE>    p_name         = lv_name</FPCLINE><FPCLINE>    p_id           = 'BMAP'</FPCLINE><FPCLINE>    p_btype        = 'BCOL'</FPCLINE><FPCLINE>  RECEIVING</FPCLINE><FPCLINE>    p_bmp          = lv_field</FPCLINE><FPCLINE>  EXCEPTIONS</FPCLINE><FPCLINE>    not_found      = 1</FPCLINE><FPCLINE>    internal_error = 2</FPCLINE><FPCLINE>    OTHERS         = 3.</FPCLINE><FPCLINE>IF sy-subrc EQ 0.</FPCLINE><FPCLINE>  gv_logo = lv_field.</FPCLINE><FPCLINE>ENDIF.</FPCLINE><FPCLINE/><FPCLINE/><FPCLINE>CLEAR: ls_f28, ls_bsad, ls_bseg, ls_kna1, ls_data, ls_tab.</FPCLINE><FPCLINE>REFRESH: lt_f28, lt_bsad, lt_bseg.</FPCLINE></INITIALIZATION><FORMS/></CL_FP_CODING></cls:CL_FP_CODING></asx:heap></asx:abap>